<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE concept
  PUBLIC "-//OASIS//DTD DITA Concept//EN" "concept.dtd">
<concept id="topic_8_10" xtrc="/w:document/w:body[1]/w:p[1651]" xml:lang="en-US">
  <title>Object functions</title>
  <conbody >
    <section><title>OBJECT_LENGTH(expression)</title>
      <p>This function returns the number of name-value pairs in the object. You can specify an
        object or an expression that evaluates to an object.</p><codeblock spectitle="Example">go_cbq> SELECT object_length(`travel-sample`.schedule[0]) 
FROM `travel-sample` 
WHERE type = "route"  
LIMIT 1;

"results" : [
    {
        "$1": 3
    }
]</codeblock>
   </section>
    <section><title>OBJECT_NAMES(expression)</title>
      <p>This function returns an array containing the attribute names of the object, in N1QL
        collation order.</p>
      <codeblock spectitle="Example">go_cbq> SELECT object_names(`travel-sample`.schedule[0]) 
FROM `travel-sample` 
WHERE type = "route" 
LIMIT 1;

"results" : [
    {
        "$1": [
            "day",
            "flight",
            "utc"
        ]
    }
]</codeblock>
    </section>
    <section><title>OBJECT_PAIRS(expression)</title>
            <p><i>Alias</i>: <b>OBJECT_OUTER_PAIRS(expression)</b></p>
        <p>This function returns an array of arrays of values which contain the attribute name and value pairs of the object, in N1QL collation order of the names. Similar to an OUTER JOIN, this function returns every parent document, irrespective of whether the document has a child or not.</p>
      <codeblock spectitle="Example"><!--go_cbq> SELECT object_pairs(`travel-sample`.schedule[0]) 
FROM `travel-sample` 
WHERE type = "route" 
LIMIT 1;
    
"results" : [
    {
        "$1": [
            {
                "name": "day",
                "value": 0
            },
            {
                "name": "flight",
                "value": "AF552"
            },
            {
                "name": "utc",
                "value": "14:41:00"
            }
        ]
    }
] -->
//Update the travel-sample bucket
go_cbq> UPDATE `travel-sample` 
            SET schedule[0] = { "day" : 7, 
                                "special_flights" : [ 
                                    { "flight" : "AI444", "utc" : "4:44:44", "codename":"green" }, 
                                    { "flight" : "AI333", "utc" : "3:33:33" },
                                    { "flight" : "AI222", "utc" : "2:22:22", "codename": "yellow" } 
                                ] 
                              } 
            WHERE type = "route" AND destinationairport = "CDG" AND sourceairport = "TLV";

//Run the example function
go_cbq> SELECT object_pairs(`travel-sample`.schedule[0]) 
            FROM `travel-sample` 
            WHERE type = "route" AND destinationairport = "CDG" AND sourceairport = "TLV" 
            LIMIT 1;

{
    "requestID": "70b4d082-0789-4edb-9771-7be6345a74df",
    "signature": {
            "$1": "array"
        },
    "results" : [
	{
            "$1": [
                {
                    "name": "day",
                    "value": 7
                },
                {
                    "name": "special_flights",
                    "value": [
                        {
                            "codename": "green",
                            "flight": "AI444",
                            "utc": "4:44:44"
                        },
                        {
                            "flight": "AI333",
                            "utc": "3:33:33"
                        },
                        {
                            "codename": "yellow",
                            "flight": "AI222",
                            "utc": "2:22:22"
                        }
                    ]
                }
            ]
        }
    ]  </codeblock>
    </section>
      <section><title>OBJECT_INNER_PAIRS(expression)</title>
          <p>This function returns an array values or name-value pairs which contain the attribute name and value pairs of the object, in N1QL collation order of the names. Similar to an INNER JOIN operation, this function returns only the documents for which the parent has a relationship with a child. </p> 
          <codeblock spectitle="Example">//Update the travel-sample bucket
go_cbq> UPDATE `travel-sample` 
            SET schedule[0] = { "day" : 7, 
                                "special_flights" : [ 
                                    { "flight" : "AI444", "utc" : "4:44:44", "codename":"green" }, 
                                    { "flight" : "AI333", "utc" : "3:33:33" }, 
                                    { "flight" : "AI222", "utc" : "2:22:22", "codename": "yellow" }
                                ] 
                              } 
            WHERE type = "route" AND destinationairport = "CDG" AND sourceairport = "TLV";

//Run the example function
go_cbq> SELECT object_inner_pairs(`travel-sample`.schedule[0]) 
            FROM `travel-sample` 
            WHERE type = "route" AND destinationairport = "CDG" AND sourceairport = "TLV" 
            LIMIT 1;
{
    "requestID": "892ea60d-7492-428b-98c1-1096666f077e",
    "signature": {
            "$1": "array"
        },
    "results" : [
	
	],
    "status": "success",
    "metrics": {
         ...
        }
}</codeblock>
      </section>
    <section><title>OBJECT_VALUES(expression) </title>
            <p><i>Alias</i>: <b>OBJECT_OUTER_VALUES(expression)</b></p>
        <p>This function returns an array of arrays of values which contain the attribute values of the object, in N1QL collation order of the corresponding names. Similar to an OUTER JOIN, this function returns every parent document, irrespective of whether the document has a child or not.</p>
      <codeblock spectitle="Example">//Update the travel-sample bucket
go_cbq> UPDATE `travel-sample` 
            SET schedule[0] = { "day" : 7, 
                                "special_flights" : [ 
                                    { "flight" : "AI444", "utc" : "4:44:44", "codename":"green" }, 
                                    { "flight" : "AI333", "utc" : "3:33:33" }, 
                                    { "flight" : "AI222", "utc" : "2:22:22", "codename": "yellow" }
                                ] 
                              } 
            WHERE type = "route" AND destinationairport = "CDG" AND sourceairport = "TLV";

//Run the example function
go_cbq> SELECT object_values(`travel-sample`.schedule[0]) 
            FROM `travel-sample` 
            WHERE type = "route" AND destinationairport = "CDG" AND sourceairport = "TLV" 
            LIMIT 1;
{
    "requestID": "337ac4e8-1aae-4cc4-9060-1e7a470265d0",
    "signature": {
            "$1": "array"
        },
    "results" : [
	{
            "$1": [
                7,
                [
                    {
                        "codename": "green",
                        "flight": "AI444",
                        "utc": "4:44:44"
                    },
                    {
                        "flight": "AI333",
                        "utc": "3:33:33"
                    },
                    {
                        "codename": "yellow",
                        "flight": "AI222",
                        "utc": "2:22:22"
                    }
                ]
            ]
        }
	],
    "status": "success",
    "metrics": {
            ...
        }
}</codeblock>
    </section>
      <section><title>OBJECT_INNER_VALUES(expression)</title>
          <p>This function returns an array of values or name-value pairs which contain the attribute values of the object, in N1QL collation order of the corresponding names. Similar to an INNER JOIN operation, this function returns only the documents for which the parent has a relationship with a child.</p>
          <codeblock spectitle="Example">//Update the travel-sample bucket
go_cbq> UPDATE `travel-sample` 
            SET schedule[0] = { "day" : 7, 
                                "special_flights" : [ 
                                    { "flight" : "AI444", "utc" : "4:44:44", "codename":"green" }, 
                                    { "flight" : "AI333", "utc" : "3:33:33" }, 
                                    { "flight" : "AI222", "utc" : "2:22:22", "codename": "yellow" }
                                ] 
                              } 
            WHERE type = "route" AND destinationairport = "CDG" AND sourceairport = "TLV";

//Run the example function
go_cbq> SELECT object_inner_values(`travel-sample`.schedule[0]) 
            FROM `travel-sample` 
            WHERE type = "route" AND destinationairport = "CDG" AND sourceairport = "TLV" 
            LIMIT 1;
{
    "requestID": "3bc792cf-fc90-421a-9a55-38a331fa6b3e",
    "signature": {
            "$1": "array"
        },
    "results" : [
	
	],
    "status": "success",
    "metrics": {
            ...
        }
}</codeblock>
      </section>
    <section><title>OBJECT_ADD()</title><p>This function adds new attributes and values to a given
        object and returns the updated
      object.</p><codeblock>object_add(<varname>object</varname>, <varname>new_attr_key</varname>, <varname>new_attr_value</varname>)</codeblock>
      Note that: <ul id="ul_tb5_z1b_1v">
        <li>This function does not perform key substitution.</li>
        <li>If you add a duplicate attribute (that is, if the key is found), it returns an error or
          NULL object.</li>
        <li>If <varname>new_attr_key</varname> or <varname>new_attr_value</varname> is MISSING, or
          if <varname>new_attr_key</varname> is NULL, it returns the <varname>object</varname>
          unmodified.</li>
        <li>If <varname>object</varname> is not an object or NULL, it returns a NULL value
          object.</li>
      </ul><codeblock spectitle="Example">go_cbq> SELECT object_add(schedule[0], "day_new", 1) 
            FROM `travel-sample` 
            WHERE type = "route"  
            LIMIT 1;

            "results" : [
                {
                    "$1": {
                        "day": 0,
                        "day_new": 1,
                        "flight": "AF552",
                        "utc": "14:41:00"
                    }
                }
            ]       </codeblock></section>
    <section> <title>OBJECT_PUT()</title>
      <p>This function adds new or updates existing attributes and values to a given object, and
        returns the updated object.
        <codeblock>object_put(<varname>object</varname>, <varname>attr_key</varname>, <varname>attr_value</varname>)</codeblock>
        Note that: <ul id="ul_kck_2db_1v">
          <li>If <varname>attr_key</varname> is found in the object, it replaces the corresponding
            attribute value by <varname>attr_value</varname>.</li>
          <li>If <varname>attr_value</varname> is MISSING, it deletes the corresponding existing key
            (if any), like<cmdname> object_remove()</cmdname>.</li>
          <li>If <varname>attr_key</varname> is MISSING, it returns a MISSING value.</li>
          <li>If <varname>attr_key</varname> is not an object, it returns a NULL value.</li>
        </ul><codeblock spectitle="Example">go_cbq> SELECT object_put(schedule[0], "day", 1)  
          FROM `travel-sample` 
          WHERE type = "route"  
          LIMIT 1;

          "results" : [
              {
                  "$1": {
                      "day": 1,
                      "flight": "AF552",
                      "utc": "14:41:00"
                  }    
              }
          ]</codeblock></p>
    </section>
    
    <section><title>OBJECT_REMOVE()</title>
      <p>This function removes the specified attribute and corresponding values from the given
        object.
        <codeblock>object_remove(<varname>object</varname>, <varname>attr_key</varname>)</codeblock>
        Note that: <ul>
          <li>If the <varname>attr_key</varname> is MISSING, it returns a MISSING value.</li>
          <li>If the <varname>attr_key</varname> is not an object, it returns a NULL value.</li>
        </ul><codeblock spectitle="Example">go_cbq> SELECT object_remove(schedule[0], "day")  
              FROM `travel-sample` 
              WHERE type = "route"  
              LIMIT 1;

              "results" : [
                  {
                      "$1": {
                          "flight": "AF552",
                          "utc": "14:41:00"
                      }
                  }
              ]         </codeblock></p>
    </section>   
      <section><title>OBJECT_UNWRAP(expression)</title>
          <p>This function enables you to unwrap an object without knowing the name in the name-value pair. It accepts only one argument and if the argument is an object with exactly one name-value pair, this function returns the value in the name-value pair. If the argument is MISSING, it returns MISSING. For all other cases, it returns NULL. </p> 
          <codeblock spectitle="Examples">go_cbq> select object_unwrap( {"name": "value"} );
          
          "results" : [
              {
                  "$1": "value"
              }
          ]
          
go_cbq> select object_unwrap( {"name": "MISSING" } );
            
            "results" : [
                {
                    "$1": "MISSING"
                }
            ]
          
go_cbq> select object_unwrap( { "name": "value", "name2": "value2" } );
           
            "results" : [
                {
                    "$1": null
                }
            ]

go_cbq> select object_unwrap("some-string");

            "results" : [
                {
                    "$1": null
                }
            ]     </codeblock>
      </section>
  </conbody>
</concept>
