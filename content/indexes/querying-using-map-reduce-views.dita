<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE concept PUBLIC "-//OASIS//DTD DITA Concept//EN" "concept.dtd">
<concept id="concept_cly_qgb_ys">
 <title>Querying using Map-Reduce views</title>
 <shortdesc>Map-Reduce views support a variety of different use-cases and can be used as a primary index, secondary index, complex secondary indexes using composite keys, and to support basic aggregation using reduce functions.</shortdesc>
 <conbody>
  <section><title>View creation</title>
   <p>You can create a simple view by defining a JavaScript map function that generates output data which represents a mapping of the documents stored within the bucket.</p>
   <p>Consider the following example of a simple map function written in JavaScript that returns the document id and the name attribute. 
    <codeblock>
     function map( doc, meta )
     {
      if(doc.name != null)
      {
       emit( meta.id, doc.name );
      }
     }
    </codeblock>
When you run a query using the view, the emit function generates a list of key-value pairs. The key helps identify the specific document and the value provides the detail you are looking for. Optionally, you can use a reduce function to aggregate the values produced by the map output into a single value (or a single value for each group). With Couchbase Server, you can choose to use a built-in reduce function (such as _sum, _count, and _stats) or write your own custom reduce function. </p>
  </section>
 
  <section><title>View distribution</title>
   <p>Couchbase Server uses hash-partitioning to distribute data evenly across the cluster. For example, in a cluster with four nodes, on an average each node will contain about 25% of active data. When using views, the view indexer runs locally on each node and indexes the subset of data that resides on that node. The partial view generated contains about 25% of the view results. Thus, view data is scattered and distributed evenly across the cluster nodes. </p>
   <p></p>
  </section>
  
  <section><title></title>
   <p></p>
  </section>
  
  <section><title></title>
   <p></p>
  </section>
  
  <section><title></title>
   <p></p>
  </section>
 </conbody>
</concept>
