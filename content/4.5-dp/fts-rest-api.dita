<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "topic.dtd">
<topic id="topic_ytp_sx4_1v">
  <title>REST API Reference</title>
  <body>
    <note>The REST APIs for FTS are provisional in Developer Preview. Any aspect may change significantly in the future up until GA.</note>
    <p>For Full Text Search, the REST endpoints below can be reached on port 9110. If running in a multi-node environment, you have to connect to a node with Full Text service enabled.</p>
    <section><title>Indexing</title>
      <p><b>Index Partition Defintion</b>
        <table frame="all" rowsep="1" colsep="1" id="table_z1d_3dp_4v">
          <tgroup cols="4">
            <colspec colname="c1" colnum="1" colwidth="1.0*"/>
            <colspec colname="c2" colnum="2" colwidth="1.0*"/>
            <colspec colname="c3" colnum="3" colwidth="1.75*"/>
            <colspec colname="c4" colnum="4" colwidth="1.0*"/>
            <thead>
              <row>
                <entry>HTTP Method</entry>
                <entry>URI Path</entry>
                <entry>Description</entry>
                <entry>Permission</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>GET</entry>
                <entry>/api/pindex</entry>
                <entry>Get information about an index partition.</entry>
                <entry>cluster.bucket[<varname>bucket_name</varname>].fts!read</entry>
              </row>
              </tbody>
            </tgroup>
          </table>
        </p>
    </section>
    <section><title>Node</title>
      <p><b>Node Configuration</b>
        <table frame="all" rowsep="1" colsep="1" id="table_z1d_3dp_7v">
          <tgroup cols="4">
            <colspec colname="c1" colnum="1" colwidth="1.0*"/>
            <colspec colname="c2" colnum="2" colwidth="1.0*"/>
            <colspec colname="c3" colnum="3" colwidth="1.75*"/>
            <colspec colname="c4" colnum="4" colwidth="1.0*"/>
            <thead>
              <row>
                <entry>HTTP Method</entry>
                <entry>URI Path</entry>
                <entry>Description</entry>
                <entry>Permission</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>GET</entry>
                <entry><filepath>/api/cfg</filepath></entry>
                <entry>Returns the node's current view of the cluster's configuration as JSON.</entry>
                <entry>cluster.settings!read</entry>
              </row>
              <row>
                <entry>POST</entry>
                <entry><filepath>/api/cfgRefresh</filepath></entry>
                <entry>Requests the node to refresh its configuration from the configuration provider.</entry>
                <entry>cluster.settings!write</entry>
              </row>
              <row>
                <entry>POST</entry>
                <entry><filepath>/api/managerKick</filepath></entry>
                <entry>Forces the node to replan resource assignments (by running the planner, if enabled) and to update its runtime state to reflect the latest plan (by running the janitor, if enabled).</entry>
                <entry>cluster.settings!write</entry>
              </row>
              <row>
                <entry>GET</entry>
                <entry><filepath>/api/managerMeta</filepath></entry>
                <entry>Returns information on the node's capabilities, including available indexing and storage options as JSON, and is intended to help management tools and web UI's to be more dynamically metadata driven.</entry>
                <entry>cluster.settings!read</entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </p>
      <p><b>Node Diagnostics</b>
        <table frame="all" rowsep="1" colsep="1" id="table_z1d_3dp_6v">
          <tgroup cols="4">
            <colspec colname="c1" colnum="1" colwidth="1.0*"/>
            <colspec colname="c2" colnum="2" colwidth="1.0*"/>
            <colspec colname="c3" colnum="3" colwidth="1.75*"/>
            <colspec colname="c4" colnum="4" colwidth="1.0*"/>
            <thead>
              <row>
                <entry>HTTP Method</entry>
                <entry>URI Path</entry>
                <entry>Description</entry>
                <entry>Permission</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>GET</entry>
                <entry><filepath>/api/diag</filepath></entry>
                <entry>Returns the full set of diagnostic information from the node in one shot as JSON. That is, the /api/diag response will be the union of the responses from the other REST API diagnostic and monitoring endpoints from the node, and is intended to make production support easier. <p>For example, for a three node cluster, you could capture the /api/diag output of each node with something like: <codeblock>curl http://cbft-01:9110/api/diag > cbft-01.json
curl http://cbft-02:9110/api/diag > cbft-02.json
curl http://cbft-03:9110/api/diag > cbft-03.json</codeblock>The /api/diag response JSON object can be quite large, from 100's of KB to much more.</p> <p>The motivation for /api/diag is to simplify working with the Couchbase community, forums, technical support and other engineers by making data capture from each FTS node a single step.</p></entry>
                <entry>cluster.logs!read</entry>
              </row>
              <row>
                <entry>GET</entry>
                <entry><filepath>/api/log</filepath></entry>
                <entry>Returns recent log messages and key events for the node as JSON.</entry>
                <entry>cluster.logs!read</entry>
              </row>
              <row>
                <entry>GET</entry>
                <entry><filepath>/api/runtime</filepath></entry>
                <entry>Returns information on the node's software, such as version strings and slow-changing runtime settings as JSON.</entry>
                <entry>cluster.settings!read</entry>
              </row>
              <row>
                <entry>GET</entry>
                <entry><filepath>/api/runtime/args</filepath></entry>
                <entry>Returns information on the node's command-line, parameters, environment variables and O/S process values as JSON.</entry>
                <entry>cluster.settings!read</entry>
              </row>
              <row>
                <entry>POST</entry>
                <entry><filepath>/api/runtime/profile/cpu</filepath></entry>
                <entry>Requests the node to capture local cpu usage profiling information.</entry>
                <entry>cluster.admin</entry>
              </row>
              <row>
                <entry>POST</entry>
                <entry><filepath>/api/runtime/profile/memory</filepath></entry>
                <entry>Requests the node to capture lcoal memory usage profiling information.</entry>
                <entry>cluster.admin</entry>
              </row>
              <row>
                <entry>GET</entry>
                <entry>/api/pindex</entry>
                <entry>Get information about an index partition.</entry>
                <entry>cluster.bucket[<varname>bucket_name</varname>].fts!read</entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </p>
      <p><b>Node Management</b>
        <table frame="all" rowsep="1" colsep="1" id="table_z1d_3dp_5v">
          <tgroup cols="4">
            <colspec colname="c1" colnum="1" colwidth="1.0*"/>
            <colspec colname="c2" colnum="2" colwidth="1.0*"/>
            <colspec colname="c3" colnum="3" colwidth="1.75*"/>
            <colspec colname="c4" colnum="4" colwidth="1.0*"/>
            <thead>
              <row>
                <entry>HTTP Method</entry>
                <entry>URI Path</entry>
                <entry>Description</entry>
                <entry>Permission</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>POST</entry>
                <entry><filepath>/api/runtime/gc</filepath></entry>
                <entry>Requests the node to perform a GC.</entry>
                <entry>cluster.admin</entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </p>
      <p><b>Node Monitoring</b>
        <table frame="all" rowsep="1" colsep="1" id="table_z1d_3dp_3v">
          <tgroup cols="4">
            <colspec colname="c1" colnum="1" colwidth="1.0*"/>
            <colspec colname="c2" colnum="2" colwidth="1.0*"/>
            <colspec colname="c3" colnum="3" colwidth="1.75*"/>
            <colspec colname="c4" colnum="4" colwidth="1.0*"/>
            <thead>
              <row>
                <entry>HTTP Method</entry>
                <entry>URI Path</entry>
                <entry>Description</entry>
                <entry>Permission</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>GET</entry>
                <entry><filepath>/api/runtime/stats</filepath></entry>
                <entry>Returns information on the node's low-level runtime stats as JSON.</entry>
                <entry></entry>
              </row>
              <row>
                <entry>GET</entry>
                <entry><filepath>/api/runtime/statsMem</filepath></entry>
                <entry>Returns information on the node's low-level GC and memory related runtime stats as JSON.</entry>
                <entry></entry>
              </row>
            </tbody>
          </tgroup>
        </table>
      </p>
    </section>
    <section><title>Advanced</title>
      <p><b>Index Partition Defintion</b>
        <table frame="all" rowsep="1" colsep="1" id="table_z1d_3dp_1v">
          <tgroup cols="4">
            <colspec colname="c1" colnum="1" colwidth="1.0*"/>
            <colspec colname="c2" colnum="2" colwidth="1.0*"/>
            <colspec colname="c3" colnum="3" colwidth="1.75*"/>
            <colspec colname="c4" colnum="4" colwidth="1.0*"/>
            <thead>
              <row>
                <entry>HTTP Method</entry>
                <entry>URI Path</entry>
                <entry>Description</entry>
                <entry>Permission</entry>
              </row>
            </thead>
            <tbody>
              <row>
                <entry>GET</entry>
                <entry><filepath>/api/pindex</filepath></entry>
                <entry>Get information about an index partition.</entry>
                <entry>cluster.bucket[<varname>bucket_name</varname>].fts!read</entry>
              </row>
              <row>
                <entry>GET</entry>
                <entry><filepath>/api/pindex/{pindexName}</filepath></entry>
                <entry/>
                <entry>cluster.bucket[<varname>bucket_name</varname>].fts!read</entry>
              </row>
            </tbody>
          </tgroup>
        </table></p>
      <p><b>Index Partition Querying</b><table frame="all" rowsep="1" colsep="1" id="table_z1d_3dp_2v">
        <tgroup cols="4">
          <colspec colname="c1" colnum="1" colwidth="1.0*"/>
          <colspec colname="c2" colnum="2" colwidth="1.0*"/>
          <colspec colname="c3" colnum="3" colwidth="1.75*"/>
          <colspec colname="c4" colnum="4" colwidth="1.0*"/>
          <thead>
            <row>
              <entry>HTTP Method</entry>
              <entry>URI Path</entry>
              <entry>Description</entry>
              <entry>Permission</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry>GET </entry>
              <entry>/api/pindex/{pindexName}/count</entry>
              <entry/>
              <entry>cluster.bucket[<varname>bucket_name</varname>].fts!read</entry>
            </row>
            <row>
              <entry>POST</entry>
              <entry><filepath>/api/pindex/{pindexName}/query</filepath></entry>
              <entry/>
              <entry>cluster.bucket[<varname>bucket_name</varname>].fts!read</entry>
            </row>
          </tbody>
        </tgroup>
      </table>
      </p>
    </section>
  </body>
</topic>
