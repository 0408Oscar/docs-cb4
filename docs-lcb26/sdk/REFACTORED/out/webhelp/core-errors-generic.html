
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html xml:lang="en-us" lang="en-us">
<head><meta name="description" content="An error is received if an operation could not be executed. Sometimes errors are received directly from the server while other times they are generated internally by the client. Errors are divided ..."></meta><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><meta name="copyright" content="(C) Copyright 2005"></meta><meta name="DC.rights.owner" content="(C) Copyright 2005"></meta><meta name="DC.Type" content="concept"></meta><meta name="DC.Title" content="Core Errors"></meta><meta name="abstract" content="An error is received if an operation could not be executed. Sometimes errors are received directly from the server while other times they are generated internally by the client."></meta><meta name="description" content="An error is received if an operation could not be executed. Sometimes errors are received directly from the server while other times they are generated internally by the client."></meta><meta name="DC.Relation" scheme="URI" content="exceptions-diagnostics-toplevel.html"></meta><meta name="DC.Format" content="XHTML"></meta><meta name="DC.Identifier" content="concept_ybj_tqs_zs"></meta><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/commonltr.css"><!----></link><title>Core Errors</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/css/webhelp_topic.css"><!----></link><link rel="stylesheet" type="text/css" href="oxygen-webhelp/resources/skins/skin.css"><!----></link><script type="text/javascript"><!--
          
          var prefix = "index.html";
          
          --></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-1.8.2.min.js"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.cookie.js"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery-ui.custom.min.js"><!----></script><script type="text/javascript" src="oxygen-webhelp/resources/js/jquery.highlight-3.js"><!----></script><script type="text/javascript" charset="utf-8" src="oxygen-webhelp/resources/js/webhelp_topic.js"><!----></script></head>
<body onload="highlightSearchTerm()" class="frmBody" id="concept_ybj_tqs_zs">
<table class="nav"><tbody><tr><td colspan="2"><div id="printlink"><a href="javascript:window.print();" title="Print this page"></a></div><div id="permalink"><a href="#" title="Link to this page"></a></div></td></tr><tr><td width="75%"><a class="navheader_parent_path" href="exceptions-diagnostics-toplevel.html" title="Errors and Diagnostics">Errors and Diagnostics</a></td><td><div class="navheader">
<span class="navparent"><a class="link" href="exceptions-diagnostics-toplevel.html" title="Errors and Diagnostics"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Errors and Diagnostics</span></a></span>  </div></td></tr></tbody></table>

    <h1 class="title topictitle1">Core Errors</h1>

    
    <div class="body conbody"><p class="shortdesc">An error is received if an operation could not be executed. Sometimes errors are
        received directly from the server while other times they are generated internally by the
        client.</p>

        
        <p class="p">Errors are divided into several categories based on their cause and the ways to handle
            them.</p>

        
        <div class="section" id="concept_ybj_tqs_zs__devguide-data-errors"><h2 class="title sectiontitle">Data errors</h2>
            
            
            <p class="p">Data errors are errors returned by the data store because a certain data condition
                was not met. Data errors typically have very clear corrective paths.</p>

            
            <p class="p"><strong class="ph b">Item not found</strong></p>

            <p class="p">If an item is not found, then it has either not yet been created or has since been
                deleted. It is received on retrieval (<em class="ph i">get</em>) operations (get an item),
                    <em class="ph i">replace</em> operations (replace an item that already exists), and
                    <em class="ph i">remove</em> operations (delete an existing item).</p>

            <p class="p">If this error is received when attempting to retrieve an item, then the item
                should either be created (if possible) or return an error to the user.</p>

            <p class="p">If this error is received when replacing an item, then it indicates an issue in the
                application state (perhaps you can raise an exception up the stack). If you do not
                care that the item exists, the <em class="ph i">upsert</em> method may be used instead.</p>

            <p class="p">If receiving this error when removing an item, it may safely be ignored:
                not-found on remove essentially means the item is already removed.</p>

            <p class="p">The Not Found error is returned by the server.</p>
           
            
            <p class="p"><strong class="ph b">Item already exists</strong></p>

            <p class="p">The <em class="ph i">insert</em> operation require that the item not yet exist; it is intended to
                create a new unique record (think about inserting a “new user ID”). This error is
                returned by the server when an item already exists. Applications at this point
                should probably return an error up the stack to the user (when applicable); for
                example indicating that a new account could not be registered with the given user
                name, since it already exists.</p>
    	
            
            <p class="p"><strong class="ph b">CAS mismatch</strong></p>

            <p class="p">A <a class="xref" href="cas-concurrency.html#concept_iq4_bts_zs">CAS</a> mismatch error is returned
                when an operation was executed with a CAS value (supplied by the application) and
                the CAS value passed differs from the CAS value on the server. The corrective course
                of action in this case is for the application to re-try the read-update cycle as
                explained in detail in the CAS documentation.</p>

            
        </div>

        
        
        <div class="section" id="concept_ybj_tqs_zs__devguide-transient-errors"><h2 class="title sectiontitle">Transient and resource errors</h2>
            
            
            <p class="p">These errors may be received because of resource starvation.</p>

            
            
            <p class="p"><strong class="ph b">Temporary failure</strong></p>

            <p class="p">This item is received during mutations when the cluster node has run out of
                memory. Its disk and replication queues are full and must wait until items in
                those queues are stored and replicated before it can begin receiving new
                operations.</p>

            <p class="p">While this condition is rare, it may happen under massively concurrent writes
                from clients and a limited memory allocation on the server.</p>

            <p class="p">The short-term corrective action for this error is to throttle and slow down the
                application, giving Couchbase some time for pending operations to complete
                before issuing new operations. The long term corrective action is to increase
                memory capacity on the cluster, either by adding more RAM to each node, or by
                adding more nodes.</p>

            <p class="p">The temporary failure error is returned from the server.</p>

            
            
            <p class="p"><strong class="ph b">Timeouts</strong></p>

            <p class="p">While technically a transient error, discussion of timeouts and their handling
                warrants a special section.</p>

            <p class="p">Timeouts are returned by the client when an operation is waiting too long for an
                acknowledgment from the server. The length of time a client waits for an a
                response from the server is configurable (see your language’s Couchbase SDK
                reference for how to configure it).</p>

            <div class="p">Timeouts are caused by an unresponsive network or software system. Possible
                causes are:<ol class="ol">
                    <li class="li">Congested network.</li>

                    <li class="li">Heavy CPU load on the server.</li>

                    <li class="li">Heavy CPU load on the client.</li>

                    <li class="li">Physical disruption between client and server</li>

                </ol>
Applications should generally <strong class="ph b">not</strong> retry an operation if it resulted
                in a timeout before performing corrective action and/or analysis to determine
                the cause of these timeouts.</div>

            <div class="p">If your application cannot simply return an error but must ensure that the
                operation completes, it is suggested that you wait a while until retrying (similar to
                the mechanism used when receiving a temporary failure).<div class="note hazardstatement note"><span class="notetitle">Note:</span> 
                    <ul class="ul messagepanel" id="concept_ybj_tqs_zs__messagepanel_kbb_trs_zs">
                        <li class="li typeofhazard">Timeout does not mean the operation failed.</li>

                        <li class="li howtoavoid">It is important to note that receipt of a timeout error does not
                            mean the operation did not complete. It means the server did not respond in
                            a timely fashion. It is possible that the operation completed on the server,
                            but the acknowledgment response was not received by the client. If the CAS
                            of the item is known, you may use it to guard against performing the same
                            operation twice.</li>

                    </ul>

                </div>
</div>

            
            
            
            
            <p class="p"><strong class="ph b">Network errors</strong></p>

            <p class="p">Network errors are returned by the client if it cannot establish a network
                connection to the server, or if an existing network connection was terminated. The
                cause of a network error may be included in the error object itself (for example, couldn’t
                resolve host name, connection refused, no route to host).</p>

            <p class="p">Like timeout errors, network errors may be transient (indicative of a bad
                network connection). They may also be a result of a node being failed over.</p>

            <div class="p">Applications may retry operations which failed with network errors after waiting
                for a while (as in timeout errors]. Retrying operations too soon may result in
                creating massive amounts of <samp class="ph codeph">TIME_WAIT</samp> connections on the client,
                and in extreme cases, even cause system crashes or rendering it inaccessible via the network.<div class="note hazardstatement note"><span class="notetitle">Note:</span> 
                    <ul class="ul messagepanel" id="concept_ybj_tqs_zs__messagepanel_sbr_zrs_zs">
                        <li class="li typeofhazard">Network error does not indicate the failure of the
                            operation</li>

                        <li class="li howtoavoid">As in timeout errors], it is not possible to determine if an
                            operation was actually completed if it resulted in a network
                            error.</li>

                    </ul>

                </div>
For cases where it is of the utmost importance to retrieve the
                item, a <a class="xref" href="#concept_ybj_tqs_zs__devguide-replica-read">read
                    from a replica</a> can be performed. This will retrieve a potentially stale
                item.</div>

            
            
            
            
            <p class="p"><strong class="ph b">Missing nodes</strong></p>

            <p class="p">If a cluster is in a <em class="ph i">degraded</em> state where one or more nodes are <em class="ph i">failed
                over</em>, and no replicas remain to be promoted, then access to some items
                will be unavailable because there is no online cluster node which can offer
                access to them.</p>

            <div class="p">Operations which have failed with a Missing Node error will only succeed once the
                failed-over node is re-added to the cluster, or the cluster is rebalanced.<div class="note note"><span class="notetitle">Note:</span> See:
                    Handling missing node errors:</div>
</div>

            
            
        </div>

        
        
        
        
        <div class="section" id="concept_ybj_tqs_zs__devguide-replica-read"><h2 class="title sectiontitle">Reading from replicas</h2>
            
            <p class="p">High-availability applications can read documents from replicas, exchanging
                consistency for availability.</p>

            
            <p class="p">If your bucket is configured for replication, then multiple replicas of each item
                exist within the cluster. By default the client will attempt to access an item
                using its computed master or active node. This returns the current and authoritative
                version of the item as it is stored within Couchbase.</p>

            <div class="p">In conditions where access to the active node is unavailable (for example, it is
                disconnected from the network), an application may be able to access a replica
                version of the item using the <em class="ph i">get-from-replica</em> operation which queries a
                replica node for a copy of the item. <div class="note note"><span class="notetitle">Note:</span> The item received from a replica node may
                    be an older version. It is possible a newer version exists in the active node,
                    but did not manage to get replicated before the active node went
                offline.</div>
</div>

            <pre class="pre codeblock">try:
  result = cb.get("docid")
except CouchbaseNetworkError as e:
  print "Got error. Fetching from replica!"
  result = cb.get(‘docid’, replica=True)</pre>

            
        </div>

    </div>

<div class="related-links"></div>
<div class="navfooter"><!---->
<span class="navparent"><a class="link" href="exceptions-diagnostics-toplevel.html" title="Errors and Diagnostics"><span class="navheader_label">Parent topic</span><span class="navheader_separator">: </span><span class="navheader_linktext">Errors and Diagnostics</span></a></span>  </div><div class="footer">WebHelp output generated by<a href="http://www.oxygenxml.com" target="_blank"><span class="oXygenLogo"><img src="oxygen-webhelp/resources/img/LogoOxygen100x22.png" alt="Oxygen"></img></span><span class="xmlauthor">XML Author</span></a> - Trial Edition</div>
</body>
</html>